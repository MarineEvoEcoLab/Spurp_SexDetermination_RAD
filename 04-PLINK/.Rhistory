scale_color_manual(values = rep(c("grey", "lightgrey"), 22 )) +
geom_point(data=subset(don, is_highlight=="yes"), color="orange", size=2.7) +
# custom X axis:
scale_x_continuous( label = axis_df$chrom, breaks= axis_df$center, ) + xlab("Chromosome") +
scale_y_continuous(expand = c(0, 0), limits = c(0,7.55)) + ylab(expression(paste("-Log"[10], "(q-value)"))) +    # remove space between plot area and x axis with expand
# Custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = NULL,
axis.text = element_text(size = 10),
axis.title = element_text(size = 20)
) + scale_y_reverse()
png("Bayescan/up.down.lower/bay_qval_plot.png", width = 1600, res = 105)
print(bayescan_qval_plot)
dev.off()
ng("Bayescan/up.down.lower/bay_qval_plot.png", width = 1600, res = 105)
png("Bayescan/up.down.lower/bay_qval_plot.png", width = 1600, res = 105)
print(bayescan_qval_plot)
dev.off()
library(dplyr)
library(ggplot2)
COL_IND
install.packages("Jmisc")
library(Jmisc)
COL
meta <- read.delim("GenomicsBioinformatics_EnvVersion_20210111.csv", sep = ",") %>%
select(ind = bioinformatics.id, region, location, udl = H3_WShd_up.down.lower)
sample_order <- read.delim("Landscape Genomics/FF.ind.txt", header =FALSE, col.names = "ind") %>%
left_join(.,meta, by = "ind")
struc_data <- read.delim("Landscape Genomics/ADMIXTURE/STRU_FILES/LG.snps.FF.struc.log.16.meanQ", header = FALSE, sep = "", col.names = LETTERS[1:16]) %>%
cbind(.,sample_order) %>%
arrange(factor(udl, levels = c("up", "down", "lower"))) %>% arrange(factor(region, levels = c("Colville", "Kuparuk", "Sagavanirktok")))
# A B I O
filter_struc <- struc_data %>% select(A,B,I,O,K, ind, region, location, udl)
# Coville Watershed O
# n = 99
COL <- filter_struc %>% filter(region == "Colville" )
######
meta <- read.delim("GenomicsBioinformatics_EnvVersion_20210111.csv", sep = ",") %>%
select(ind = bioinformatics.id, region, location, udl = H3_WShd_up.down.lower)
getwd()
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "D:/Wegrzyn_Lab/Grayling/arcticgrayling_ddrad/Landscape Genomics/PCA")
knitr::opts_chunk$set(
fig.path = ""
)
library(tidyverse)
library(ggplot2)
library(dbplyr)
library(ggpubr)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
library(ggsci)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.009.MISS.75.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.009.MISS.75.MD.69.pruned.eigenval")
#load population map
#pop <- read.delim("../Ref_map.pl/LG_popmap.txt", header = FALSE, col.names = c("ind","pop","region"), sep = " ")
meta <- read.delim("../../GenomicsBioinformatics_EnvVersion_20210111.csv", sep=",")
meta <-meta %>%
dplyr::select(ind=bioinformatics.id,pop=popmap_initial,reg=region,H1=H1_coast.noncoast,H2=H2_Aufeis_above.below.coast,H3=H3_WShd_up.down.lower)
#remove the first column since it's repeated twice
pca <- pca[,-1]
#name the first column indv
names(pca)[1] <- "ind"
#name 2nd to number of columns in pca as PC 1 to 20
names(pca)[2:ncol(pca)] <- paste0("PC",1:(ncol(pca)-1))
#add population data to the pca dataframe by individual
joined_pca <- left_join(pca, meta, by = "ind")
knitr::kable(
head(joined_pca), format = "html",caption = "Final PCA DataFrame",
booktabs = TRUE
)
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
a <- ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity")
a + ylab("Percentage variance explained") + theme_classic()
library(ggsci)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggsave("LG.snps.FF.MAF.01.MISS.75.MD.100.PCA.png",b1,device="png")
b1 <- ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggsave("LG.snps.FF.MAF.01.MISS.75.MD.100.PCA.png",b1,device="png")
b1 <- ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggsave("LG.snps.FFP.MAF.01.MISS.75.MD.69.PCA.png",b1,device="png")
b1 <- ggplot(joined_pca, aes(PC1, PC3, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC3, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC4, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC5, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC6, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
b1 <- ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.025.MISS.75.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.025.MISS.75.MD.69.pruned.eigenval")
#load population map
#pop <- read.delim("../Ref_map.pl/LG_popmap.txt", header = FALSE, col.names = c("ind","pop","region"), sep = " ")
meta <- read.delim("../../GenomicsBioinformatics_EnvVersion_20210111.csv", sep=",")
meta <-meta %>%
dplyr::select(ind=bioinformatics.id,pop=popmap_initial,reg=region,H1=H1_coast.noncoast,H2=H2_Aufeis_above.below.coast,H3=H3_WShd_up.down.lower)
#remove the first column since it's repeated twice
pca <- pca[,-1]
#name the first column indv
names(pca)[1] <- "ind"
#name 2nd to number of columns in pca as PC 1 to 20
names(pca)[2:ncol(pca)] <- paste0("PC",1:(ncol(pca)-1))
#add population data to the pca dataframe by individual
joined_pca <- left_join(pca, meta, by = "ind")
knitr::kable(
head(joined_pca), format = "html",caption = "Final PCA DataFrame",
booktabs = TRUE
)
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
a <- ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity")
a + ylab("Percentage variance explained") + theme_classic()
library(ggsci)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC3, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenval")
#load population map
#pop <- read.delim("../Ref_map.pl/LG_popmap.txt", header = FALSE, col.names = c("ind","pop","region"), sep = " ")
meta <- read.delim("../../GenomicsBioinformatics_EnvVersion_20210111.csv", sep=",")
meta <-meta %>%
dplyr::select(ind=bioinformatics.id,pop=popmap_initial,reg=region,H1=H1_coast.noncoast,H2=H2_Aufeis_above.below.coast,H3=H3_WShd_up.down.lower)
#remove the first column since it's repeated twice
pca <- pca[,-1]
#name the first column indv
names(pca)[1] <- "ind"
#name 2nd to number of columns in pca as PC 1 to 20
names(pca)[2:ncol(pca)] <- paste0("PC",1:(ncol(pca)-1))
#add population data to the pca dataframe by individual
joined_pca <- left_join(pca, meta, by = "ind")
knitr::kable(
head(joined_pca), format = "html",caption = "Final PCA DataFrame",
booktabs = TRUE
)
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
a <- ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity")
a + ylab("Percentage variance explained") + theme_classic()
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenval")
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenval")
#load population map
#pop <- read.delim("../Ref_map.pl/LG_popmap.txt", header = FALSE, col.names = c("ind","pop","region"), sep = " ")
meta <- read.delim("../../GenomicsBioinformatics_EnvVersion_20210111.csv", sep=",")
meta <-meta %>%
dplyr::select(ind=bioinformatics.id,pop=popmap_initial,reg=region,H1=H1_coast.noncoast,H2=H2_Aufeis_above.below.coast,H3=H3_WShd_up.down.lower)
#remove the first column since it's repeated twice
pca <- pca[,-1]
#name the first column indv
names(pca)[1] <- "ind"
#name 2nd to number of columns in pca as PC 1 to 20
names(pca)[2:ncol(pca)] <- paste0("PC",1:(ncol(pca)-1))
#add population data to the pca dataframe by individual
joined_pca <- left_join(pca, meta, by = "ind")
knitr::kable(
head(joined_pca), format = "html",caption = "Final PCA DataFrame",
booktabs = TRUE
)
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
a <- ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity")
a + ylab("Percentage variance explained") + theme_classic()
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.006.MISS.75.MD.69.pruned.eigenval")
#load population map
#pop <- read.delim("../Ref_map.pl/LG_popmap.txt", header = FALSE, col.names = c("ind","pop","region"), sep = " ")
meta <- read.delim("../../GenomicsBioinformatics_EnvVersion_20210111.csv", sep=",")
meta <-meta %>%
dplyr::select(ind=bioinformatics.id,pop=popmap_initial,reg=region,H1=H1_coast.noncoast,H2=H2_Aufeis_above.below.coast,H3=H3_WShd_up.down.lower)
#remove the first column since it's repeated twice
pca <- pca[,-1]
#name the first column indv
names(pca)[1] <- "ind"
#name 2nd to number of columns in pca as PC 1 to 20
names(pca)[2:ncol(pca)] <- paste0("PC",1:(ncol(pca)-1))
#add population data to the pca dataframe by individual
joined_pca <- left_join(pca, meta, by = "ind")
knitr::kable(
head(joined_pca), format = "html",caption = "Final PCA DataFrame",
booktabs = TRUE
)
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
a <- ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity")
a + ylab("Percentage variance explained") + theme_classic()
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC3, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC4, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC5, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC2, PC5, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.008.MISS.5.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.008.MISS.5.MD.69.pruned.eigenval")
#load population map
#pop <- read.delim("../Ref_map.pl/LG_popmap.txt", header = FALSE, col.names = c("ind","pop","region"), sep = " ")
meta <- read.delim("../../GenomicsBioinformatics_EnvVersion_20210111.csv", sep=",")
meta <-meta %>%
dplyr::select(ind=bioinformatics.id,pop=popmap_initial,reg=region,H1=H1_coast.noncoast,H2=H2_Aufeis_above.below.coast,H3=H3_WShd_up.down.lower)
#remove the first column since it's repeated twice
pca <- pca[,-1]
#name the first column indv
names(pca)[1] <- "ind"
#name 2nd to number of columns in pca as PC 1 to 20
names(pca)[2:ncol(pca)] <- paste0("PC",1:(ncol(pca)-1))
#add population data to the pca dataframe by individual
joined_pca <- left_join(pca, meta, by = "ind")
knitr::kable(
head(joined_pca), format = "html",caption = "Final PCA DataFrame",
booktabs = TRUE
)
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
a <- ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity")
a + ylab("Percentage variance explained") + theme_classic()
ggplot(joined_pca, aes(PC1, PC5, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC3, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
#load eigenvectors/values
pca <- read.delim("FILES/LG.snps.FFP.MAF.01.MISS.5.MD.69.pruned.eigenvec", header = FALSE, sep = " ")
eigenval <- scan("FILES/LG.snps.FFP.MAF.01.MISS.5.MD.69.pruned.eigenval")
#load population map
#pop <- read.delim("../Ref_map.pl/LG_popmap.txt", header = FALSE, col.names = c("ind","pop","region"), sep = " ")
meta <- read.delim("../../GenomicsBioinformatics_EnvVersion_20210111.csv", sep=",")
meta <-meta %>%
dplyr::select(ind=bioinformatics.id,pop=popmap_initial,reg=region,H1=H1_coast.noncoast,H2=H2_Aufeis_above.below.coast,H3=H3_WShd_up.down.lower)
#remove the first column since it's repeated twice
pca <- pca[,-1]
#name the first column indv
names(pca)[1] <- "ind"
#name 2nd to number of columns in pca as PC 1 to 20
names(pca)[2:ncol(pca)] <- paste0("PC",1:(ncol(pca)-1))
#add population data to the pca dataframe by individual
joined_pca <- left_join(pca, meta, by = "ind")
knitr::kable(
head(joined_pca), format = "html",caption = "Final PCA DataFrame",
booktabs = TRUE
)
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
a <- ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity")
a + ylab("Percentage variance explained") + theme_classic()
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC2, PC3, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC3, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC4, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC6, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
b1 <- ggplot(joined_pca, aes(PC1, PC2, col = H3)) + geom_point(size = 3, alpha = .5) +
coord_equal() + theme_classic() +
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)")) +
labs(colour = "") + stat_ellipse(aes(group = reg)) +
#annotate("text",x = -0.030,y = -0.02, label = "Sag") +
#annotate("text",x = -0.0030,y = 0.005, label = "Kup") +
#annotate("text",x = 0.055,y = -0.02, label = "Itk") +
scale_color_igv(breaks = c("up","down","lower")) + theme(legend.position = "top") #+ geom_hline(yintercept=0) + geom_vline(xintercept=0)
ggsave("LG.snps.FFP.MAF.01.MISS.5.MD.69.PCA.png",b1,device="png")
getwd()
setwd("D:/Puritz_Lab/Spurp_SexDetermination_RAD/04-PLINK/")
plink <- read.table("Spurp.minQ20.minGQ20.mac4.miss99.assoc.logistic")
plink
plink <- read.table("Spurp.minQ20.minGQ20.mac4.miss99.assoc.logistic", h=T)
hist(plink$P)
plink <- read.table("Spurp.minQ20.minGQ20.mac4.miss99.assoc.logistic", h=T)
hist(plink$P)
plink <- read.table("Spurp.minQ20.minGQ20.mac4.miss99.assoc", h=T)
hist(plink$P)
library(tidyverse)
P %>% filter(P < .01)
plink %>% filter(P < .01)
plink %>% arrange(desc(P))
plink %>% arrange(P)
